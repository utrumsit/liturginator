# Plan-2025-11-27: Modular Format Tool for Liturginator Outputs

## Overview
The liturginator project now has a complete Orthodox lectionary system (`lectionary.py`) that outputs JSON with scripture readings. To present liturgical services (readings, psalms, prayers) in nice markdown for user consumption, we need a formatting tool. This plan outlines building a modular "formatinator" that funnels everything into markdown, allowing users to choose outputs: console viewing or pandoc/latex for beautiful PDFs.

## Current State
- `lectionary.py`: Outputs JSON with structured readings (epistle/gospel/paramia/matins) including full RSV texts.
- Psalms and prayers: Stored as markdown files in `resource/` (e.g., `resource/matins/introductory_prayers_matins.md`).
- `liturginator.py`: Placeholder; doesn't do anything yet. Assumed to generate full services by combining readings + psalms/prayers.
- Goal: Produce formatted liturgical services as markdown, pipeable to pandoc for PDFs.

## Key Decisions
- **Separate Tool:** Formatting is post-processing, not integrated into core scripts (e.g., `lectionary.py`). Keeps modularity and reusability.
- **Input:** Hybrid JSON from `liturginator.py` (structured readings + embedded markdown strings for psalms/prayers).
- **Output:** Markdown variants via modes.
- **Two Pathways:** One tool (`formatinator.py`) with modes for console (on-screen) and paper (pandoc-ready).

## Proposed Architecture
### 1. Input Handling
- JSON schema:
  ```
  {
    "title": "Service Title",
    "sections": [
      {
        "type": "readings",
        "content": [ /* dicts: {type, book, chapter, verses, text, context} */ ]
      },
      {
        "type": "psalms",
        "content": "Raw markdown string from .md files"
      },
      {
        "type": "prayers",
        "content": "Raw markdown string"
      }
    ]
  }
  ```
- `liturginator.py` will read .md files and embed as strings.

### 2. Format Tool (`formatinator.py`)
- **CLI:** `formatinator.py --mode=console|paper [--output=file.md] < input.json`
- **Shared Logic:** Parse JSON, assemble content.
- **Modes:**
  - **Console Mode:** Basic markdown for terminal. Optional ANSI colors (e.g., via `rich`). Focus on readability for praying.
  - **Paper Mode (Default):** Markdown with LaTeX hints (e.g., `\begin{verse}` for hymns). Optimized for `pandoc -o service.pdf`.

### 3. Formatting Rules
- Readings: `# Title\n\n**Book Chapter:Verses**\n\n> Text`
- Psalms/Prayers: Pass through markdown, add headers/line breaks.
- Paper: Add LaTeX for typography.

### 4. Integration
- `python liturginator.py [date] | python formatinator.py --mode=console` → Nice terminal output.
- `python liturginator.py [date] | python formatinator.py | pandoc -o service.pdf` → Beautiful PDF.

## Next Steps
- Inspect `liturginator.py` (currently empty) and implement JSON output schema.
- Implement `formatinator.py` with modes.
- Test with sample JSON/markdown.
- Add dependencies (e.g., `rich` for console colors).

## Big Picture
One source (markdown), multiple outputs: console for daily use, pandoc for print. Extensible for future content types.</content>
<parameter name="filePath">PLAN-2025-11-27.md